<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenMart - Sepet</title>
    <link rel="stylesheet" href="styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">GreenMart</a>
            <ul class="nav-links">
                <li><a href="index.html">Ana Sayfa</a></li>
                <li><a href="shop.html">MaÄŸaza</a></li>
                <li><a href="about.html">HakkÄ±mÄ±zda</a></li>
            </ul>
            <div class="nav-icons">
                <a href="#" id="weather-widget" class="weather-widget-link">
                    <span id="weather-icon">â˜€ï¸</span> <span id="weather-temp">--Â°C</span>
                </a>
                <a href="cart.html" class="cart-icon active">ğŸ›’ <span id="cart-count">0</span></a>
                <a href="login.html" class="user-icon">ğŸ‘¤ GiriÅŸ Yap</a>
            </div>
        </div>
    </nav>

    <!-- Cart Section -->
    <div class="container">
        <h2>Sepetim</h2>
        <div id="cart-items" class="cart-container">
            <!-- Items will be injected here -->
            <p>Sepetiniz boÅŸ.</p>
        </div>
        <div class="cart-total">
            <h3>Toplam: <span id="total-price">0.00</span> TL</h3>
            <button class="btn btn-primary mt-1">SipariÅŸi Tamamla</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container footer-container">
            <p>&copy; 2024 GreenMart. TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        window.onload = function () {
            // Basic count update check
            if (typeof updateCartCount === 'function') {
                updateCartCount();
            }

            const cartItems = document.getElementById('cart-items');
            const cart = JSON.parse(localStorage.getItem('cartGreen')) || [];

            if (cart.length > 0) {
                cartItems.innerHTML = ''; // Clear empty message
                let total = 0;

                cart.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'cart-item';

                    // Use item.image if available. If it's a path/URL use img tag, else use as text (fallback)
                    let imgDisplay;
                    if (item.image && (item.image.includes('/') || item.image.includes('http') || item.image.includes('.'))) {
                        imgDisplay = `<img src="${item.image}" alt="${item.name}" class="cart-item-img">`;
                    } else {
                        imgDisplay = `<span class="cart-item-icon">${item.image || 'ğŸ“¦'}</span>`;
                    }

                    div.innerHTML = `
                        <div class="cart-item-left">
                            ${imgDisplay}
                            <div>
                                <h4 class="cart-item-name">${item.name}</h4>
                            </div>
                        </div>
                        <div class="cart-item-right">
                            <span class="cart-item-price">${item.price} TL</span>
                            <br>
                            <button onclick="removeItem(${index})" class="cart-item-remove">Sil</button>
                        </div>
                    `;
                    cartItems.appendChild(div);
                    total += parseFloat(item.price);
                });
                document.getElementById('total-price').innerText = total.toFixed(2);
            }
        };

        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem('cartGreen')) || [];
            cart.splice(index, 1);
            localStorage.setItem('cartGreen', JSON.stringify(cart));
            window.location.reload();
        }
    </script>

</body>

</html>